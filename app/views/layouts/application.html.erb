<!DOCTYPE html>
<html>
<head>
  <title>swEtsy</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <link rel="icon" type="image/png" href="/assets/images/favicon-16x16.png">

  <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
</head>

<header>

  <nav class="navbar navbar-light bg-light navbar-expand-lg">

    <h1 class="navbar-brand"><%= link_to "swEtsyðŸ’¦", root_path %></h1>

    <div class="hamburger navbar-nav nav-item mr-auto">
      <button class="nav-item navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>

    <div class="browse collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav">

        <li class="nav-item nav-link">
          <%= link_to "All Products", products_path %>
        </li>

        <li class="nav-item">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Browse by Merchant</a>
          <div class="dropdown-menu pb-0">
              <% @merchants.each do |merchant| %>
                <p class="dropdown-item"><%= link_to merchant.name.capitalize, user_products_path(merchant.id) %></p>
              <% end %>
          </div>
        </li>

        <li class="nav-item">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Browse by Category</a>
          <div class="dropdown-menu pb-0">
              <% @categories.each do |category| %>
                <p class="dropdown-item"><%= link_to category.name.capitalize, category_products_path(category.id) %></p>
              <% end %>

              <% if session[:user_id] %>
<!--                <button class="btn btn-primary" data-toggle="modal" data-target="#newCategory">Add New Category</button>-->
<!--                <div class="modal" id="newCategory">-->
<!--                  <div class="modal-dialog">-->
<!--                    <div class="modal-content">-->
<!--                      <div class="modal-body">-->
<!--                        <button type="button" class="close" data-dismiss="modal">-->
<!--                          <span>&times;</span>-->
<!--                        </button>-->
                        <%= render partial: '/layouts/new_category' %>
<!--                      </div>-->
<!--                    </div>-->
<!--                  </div>-->
<!--                </div>-->
              <% end %>

          </div>
        </li>

      </ul>
    </div>


<!--    <div class="login cart navbar-nav ml-auto">-->

      <div class="login navbar-nav nav-item">
            <% if session[:user_id] %>
        <div class="nav-link">
            <%= link_to "Hi, #{@current_user.name}", current_user_path %>
        </div>
        <button class="nav-link btn btn-primary">
            <%= link_to "Log Out" , logout_path, method: :delete %>
        </button>
        <% else %>
          <button class="nav-link btn btn-primary">
              <%= link_to "Login with Github", github_login_path, method: :get %>
          </button>
        <% end %>
      </div>

      <div class="cart navbar-nav nav-item">
        <div class="cart nav-link">
          <%= link_to image_tag( "shopping-cart.png", alt: "shopping cart", width: "60rem" ), cart_path(session[:cart_id]), method: :get %>
          <span class="badge badge-primary badge-pill"><%=@current_cart.cartitems.count %></span>
        </div>
      </div>

<!--    </div>-->



  </nav>

  </header>

  <body>
    <container>
      <section class="flash">
        <% flash.each do |name, message| %>
          <p class="<%= name %>"%>
            <%= message %>
          </p>
        <% end %>
      </section>

      <%= yield %>
    </container>
  </body>

</html>
